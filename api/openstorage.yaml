swagger: '2.0'
info:
  title: Open Storage for Containers
  description: Open storage API specification
  version: 1.0.0
host: localhost
schemes:
  - https
produces:
  - application/json
paths:
  /cluster/versions/:
    get:
      summary: List of versions
      tags:
        - Clusters
      responses:
        '200':
          description: An array of version strings
          schema:
            type: array
            items:
              type: string
  /v1/cluster/enumerate/:
    get:
      summary: Retrieve cluster information
      description: |
        Returns information on the cluster
      tags:
        - Clusters
      responses:
        '200':
          description: The cluster details
          schema:
            $ref: '#/definitions/Cluster'
          examples:
              application/json: |-
                {
                  "cluster": {
                              "Status": 2,
                              "Id": "DB_CLUSTER_ID",
                              "NodeId": "e612618a-3c8f-490d-b288-674089de7254",
                              "Nodes": [
                               {
                                "Id": "e612618a-3c8f-490d-b288-674089de7254",
                                "Cpu": 9.628697293895533,
                                "MemTotal": 33585233920,
                                "MemUsed": 10144595968,
                                "MemFree": 23440637952,
                                "Avgload": 0,
                                "Status": 2,
                                "GenNumber": 1490838795607068510,
                                "Disks": null,
                                "Pools": null,
                                "MgmtIp": "192.168.1.123",
                                "DataIp": "192.168.1.123",
                                "Timestamp": "2017-03-31T20:12:19.653009696Z",
                                "StartTime": "2017-03-30T01:53:15.607377185Z",
                                "Hostname": "PXDEMO",
                                "NodeData": {
                                 "STORAGE-INFO": {
                                  "LastError": "",
                                  "Random4KIops": 0,
                                  "ReadThroughput": 0,
                                  "ResourceMdUUID": "",
                                  "ResourceUUID": "",
                                  "Resources": {
                                   "0:1": {
                                    "id": "1",
                                    "last_scan": {
                                     "nanos": 1.68896028e+08,
                                     "seconds": 1.490838812e+09
                                    },
                                    "online": true,
                                    "path": "/dev/loop0",
                                    "rotation_speed": "Unknown",
                                    "seq_write": 1.905e+09,
                                    "size": 2.147483648e+09,
                                    "used": 2.3986176e+08
                                   }
                                  },
                                  "ResourcesCount": 1,
                                  "ResourcesLastScan": "Resources Scan OK",
                                  "ResourcesMd": null,
                                  "ResourcesMdCount": 0,
                                  "ResourcesMdLastScan": "",
                                  "Status": "Up",
                                  "TotalSize": 2.147483648e+09,
                                  "Used": 0,
                                  "WriteThroughput": 0
                                 },
                                 "STORAGE-RUNTIME": {
                                  "MID": "e612618a-3c8f-490d-b288-674089de7254",
                                  "PoolUsage": {
                                   "0": {
                                    "TotalAllocated": 6.33507677e+08
                                   }
                                  },
                                  "Usage": {
                                   "TotalAllocated": 6.33507677e+08
                                  }
                                 },
                                 "storage_stats": {
                                  "Cpu": 9.628697293895533,
                                  "DiskAvail": 1.513975971e+09,
                                  "DiskTotal": 2.147483648e+09,
                                  "DiskUtil": 6.33507677e+08,
                                  "Memory": 30,
                                  "PendingIo": 0
                                 }
                                },
                                "NodeLabels": {
                                 "City": "Redwood City",
                                 "Country": "United States",
                                 "Data IP": "192.168.1.123",
                                 "ISP": "Level 3 Communications",
                                 "ISP IP": "4.15.123.2",
                                 "LAT": "3.74914E+01",
                                 "LNG": "-1.22211E+02",
                                 "Managemet IP": "192.168.1.123",
                                 "Node Count Limit": "3",
                                 "PX Version": "2.0.0-e586614",
                                 "Region": "CA",
                                 "Timezone": "America/Los_Angeles",
                                 "Zip": "94063"
                                }
                               }
                              ]
                             }
                      }
  /v1/cluster/gossipstate/:
    get:
      summary: Retrieve cluster gossipstate
      description: |
        Returns information on the clusters gossip state
      tags:
        - Clusters
      responses:
        '200':
          description: Cluster state
          schema:
            $ref: '#/definitions/ClusterState'
  /v1/cluster/status/:
    get:
      summary: Retrieve cluster status
      description: |
        Returns information on the cluster status
      parameters:
        - name: name
          in: query
          required: true
          type: string
      tags:
        - Clusters
      responses:
        '200':
          description: Cluster status
          schema:
            $ref: '#/definitions/ClusterState'
          examples:
              application/json: |-
                {
                       "status": "STATUS_OK",
                       "cluster": {
                        "Status": 2,
                        "Id": "DB_CLUSTER_ID",
                        "NodeId": "e612618a-3c8f-490d-b288-674089de7254",
                        "Nodes": [
                         {
                          "Id": "e612618a-3c8f-490d-b288-674089de7254",
                          "Cpu": 12.775330396475772,
                          "MemTotal": 33585233920,
                          "MemUsed": 10530840576,
                          "MemFree": 23054393344,
                          "Avgload": 0,
                          "Status": 2,
                          "GenNumber": 1490838795607068510,
                          "Disks": null,
                          "Pools": null,
                          "MgmtIp": "192.168.1.123",
                          "DataIp": "192.168.1.123",
                          "Timestamp": "2017-03-31T22:03:01.099095921Z",
                          "StartTime": "2017-03-30T01:53:15.607377185Z",
                          "Hostname": "PXDEMO",
                          "NodeData": {
                           "STORAGE-INFO": {
                            "LastError": "",
                            "Random4KIops": 0,
                            "ReadThroughput": 0,
                            "ResourceMdUUID": "",
                            "ResourceUUID": "",
                            "Resources": {
                             "0:1": {
                              "id": "1",
                              "last_scan": {
                               "nanos": 1.68896028e+08,
                               "seconds": 1.490838812e+09
                              },
                              "online": true,
                              "path": "/dev/loop0",
                              "rotation_speed": "Unknown",
                              "seq_write": 1.905e+09,
                              "size": 2.147483648e+09,
                              "used": 2.3986176e+08
                             }
                            },
                            "ResourcesCount": 1,
                            "ResourcesLastScan": "Resources Scan OK",
                            "ResourcesMd": null,
                            "ResourcesMdCount": 0,
                            "ResourcesMdLastScan": "",
                            "Status": "Up",
                            "TotalSize": 2.147483648e+09,
                            "Used": 0,
                            "WriteThroughput": 0
                           },
                           "STORAGE-RUNTIME": {
                            "MID": "e612618a-3c8f-490d-b288-674089de7254",
                            "PoolUsage": {
                             "0": {
                              "TotalAllocated": 6.33507677e+08
                             }
                            },
                            "Usage": {
                             "TotalAllocated": 6.33507677e+08
                            }
                           },
                           "storage_stats": {
                            "Cpu": 11.492816989381636,
                            "DiskAvail": 1.513975971e+09,
                            "DiskTotal": 2.147483648e+09,
                            "DiskUtil": 6.33507677e+08,
                            "Memory": 31,
                            "PendingIo": 0
                           }
                          },
                          "NodeLabels": {
                           "City": "Redwood City",
                           "Country": "United States",
                           "Data IP": "192.168.1.123",
                           "ISP": "Level 3 Communications",
                           "ISP IP": "4.15.123.2",
                           "LAT": "3.74914E+01",
                           "LNG": "-1.22211E+02",
                           "Managemet IP": "192.168.1.123",
                           "Node Count Limit": "3",
                           "PX Version": "2.0.0-e586614",
                           "Region": "CA",
                           "Timezone": "America/Los_Angeles",
                           "Zip": "94063"
                          }
                         }
                        ]
                       },
                       "daemoninfo": {
                        "Version": "2.0.0-e586614",
                        "IsEnterprise": false,
                        "SchedulerInfo": {
                         "DockerVersion": "1.12.3",
                         "LastError": "",
                         "Containers": null
                        },
                        "StorageSpec": {
                         "DriverName": "kernel",
                         "SwVersion": "2.0.0-e586614",
                         "BlockDriver": 0,
                         "Version": "1",
                         "NID": 1,
                         "MID": "e612618a-3c8f-490d-b288-674089de7254",
                         "PeerAddr": "tcp://192.168.1.123:9003",
                         "ClientAddr": "http://192.168.1.123:9001",
                         "StorageVol": "/var/.px",
                         "StorageVolMd": "/var/.px/0",
                         "Info": {
                          "Resources": {
                           "0:1": {
                            "id": "1",
                            "path": "/dev/loop0",
                            "online": true,
                            "seq_write": 1.905e+09,
                            "size": 2147483648,
                            "used": 239861760,
                            "rotation_speed": "Unknown",
                            "last_scan": {
                             "seconds": 1490838812,
                             "nanos": 168896028
                            }
                           }
                          },
                          "ResourcesLastScan": "Resources Scan OK",
                          "ResourcesCount": 1,
                          "ResourceUUID": "",
                          "ResourcesMd": null,
                          "ResourcesMdLastScan": "",
                          "ResourcesMdCount": 0,
                          "ResourceMdUUID": "",
                          "ReadThroughput": 0,
                          "WriteThroughput": 0,
                          "Random4KIops": 0,
                          "Status": "Up",
                          "TotalSize": 2147483648,
                          "Used": 0,
                          "LastError": ""
                         },
                         "MdInfo": {
                          "Resources": {},
                          "ResourcesLastScan": "",
                          "ResourcesCount": 0,
                          "ResourceUUID": "",
                          "ResourcesMd": null,
                          "ResourcesMdLastScan": "",
                          "ResourcesMdCount": 0,
                          "ResourceMdUUID": "",
                          "ReadThroughput": 0,
                          "WriteThroughput": 0,
                          "Random4KIops": 0,
                          "Status": "",
                          "TotalSize": 0,
                          "Used": 0,
                          "LastError": ""
                         },
                         "Geo": {
                          "Provider": "local",
                          "Region": "default",
                          "Zone": "default",
                          "Rack": "default"
                         },
                         "DebugLevel": "",
                         "Labels": {},
                         "OpStatus": "Up",
                         "ErrStatus": 0,
                         "HAOpStatus": 0,
                         "Decommissioned": false,
                         "DataPools": [
                          {
                           "Cos": 3,
                           "RaidLevel": "raid0",
                           "Info": {
                            "Resources": {
                             "1": {
                              "id": "1",
                              "path": "/dev/loop0",
                              "online": true,
                              "seq_write": 1.905e+09,
                              "size": 2147483648,
                              "used": 239861760,
                              "rotation_speed": "Unknown",
                              "last_scan": {
                               "seconds": 1490838812,
                               "nanos": 168896028
                              }
                             }
                            },
                            "ResourcesLastScan": "Resources Scan OK",
                            "ResourcesCount": 1,
                            "ResourceUUID": "c1e09ac6-0c51-4200-9f3d-8c2989dfaf18",
                            "ResourcesMd": null,
                            "ResourcesMdLastScan": "",
                            "ResourcesMdCount": 0,
                            "ResourceMdUUID": "",
                            "ReadThroughput": 0,
                            "WriteThroughput": 1.905e+09,
                            "Random4KIops": 0,
                            "Status": "Up",
                            "TotalSize": 2147483648,
                            "Used": 0,
                            "LastError": ""
                           },
                           "Status": "Up",
                           "ReserveFactor": 0,
                           "SnapReserveFactor": 0
                          }
                         ],
                         "MdPoolID": 0,
                         "RaidLevel": "",
                         "ScanSchedule": "",
                         "AsyncIO": false,
                         "NumThreads": 0
                        }
                       }
                      }
  /v1/cluster/peerstatus/:
    get:
      summary: Retrieve peer node information
      description: |
        Returns information on the peer node status
      parameters:
        - name: name
          in: query
          required: true
          type: string
      tags:
        - Clusters
      responses:
        '200':
          description: Peer node status
          schema:
            $ref: '#/definitions/ClusterState'
  /v1/cluster/inspect/{uuid}/:
    get:
      summary: Retrieve cluster node stats
      description: |
        Returns stats for the specified node
      parameters:
        - name: uuid
          in: path
          description: Node UUID
          required: true
          type: string
          format: uuid
      tags:
        - Clusters
      responses:
        '200':
          description: Stats
          schema:
            type: array
            items:
              $ref: '#/definitions/StatPoint'
          examples:
             application/json: |-
              {
                "Id": "e612618a-3c8f-490d-b288-674089de7254",
                "Cpu": 10.163111668757843,
                "MemTotal": 33585233920,
                "MemUsed": 10582343680,
                "MemFree": 23002890240,
                "Avgload": 0,
                "Status": 2,
                "GenNumber": 1490838795607068400,
                "Disks": null,
                "Pools": null,
                "MgmtIp": "192.168.1.123",
                "DataIp": "192.168.1.123",
                "Timestamp": "2017-03-31T22:35:00.268574343Z",
                "StartTime": "2017-03-30T01:53:15.607377185Z",
                "Hostname": "PXDEMO",
                "NodeData": {
                  "STORAGE-INFO": {
                    "LastError": "",
                    "Random4KIops": 0,
                    "ReadThroughput": 0,
                    "ResourceMdUUID": "",
                    "ResourceUUID": "",
                    "Resources": {
                      "0:1": {
                        "id": "1",
                        "last_scan": {
                          "nanos": 168896028,
                          "seconds": 1490838812
                        },
                        "online": true,
                        "path": "/dev/loop0",
                        "rotation_speed": "Unknown",
                        "seq_write": 1905000000,
                        "size": 2147483648,
                        "used": 239861760
                      }
                    },
                    "ResourcesCount": 1,
                    "ResourcesLastScan": "Resources Scan OK",
                    "ResourcesMd": null,
                    "ResourcesMdCount": 0,
                    "ResourcesMdLastScan": "",
                    "Status": "Up",
                    "TotalSize": 2147483648,
                    "Used": 0,
                    "WriteThroughput": 0
                  },
                  "STORAGE-RUNTIME": {
                    "MID": "e612618a-3c8f-490d-b288-674089de7254",
                    "PoolUsage": {
                      "0": {
                        "TotalAllocated": 633507677
                      }
                    },
                    "Usage": {
                      "TotalAllocated": 633507677
                    }
                  },
                  "storage_stats": {
                    "Cpu": 9.598494353826851,
                    "DiskAvail": 1513975971,
                    "DiskTotal": 2147483648,
                    "DiskUtil": 633507677,
                    "Memory": 31,
                    "PendingIo": 0
                  }
                },
                "NodeLabels": {
                  "City": "Redwood City",
                  "Country": "United States",
                  "Data IP": "192.168.1.123",
                  "ISP": "Level 3 Communications",
                  "ISP IP": "4.15.123.2",
                  "LAT": "3.74914E+01",
                  "LNG": "-1.22211E+02",
                  "Managemet IP": "192.168.1.123",
                  "Node Count Limit": "3",
                  "PX Version": "2.0.0-e586614",
                  "Region": "CA",
                  "Timezone": "America/Los_Angeles",
                  "Zip": "94063"
                }
              }
  /v1/cluster/{uuid}/:
    delete:
      summary: Delete node
      description: |
        Removes a node from the cluster
      parameters:
        - name: uuid
          in: path
          description: Node UUID
          required: true
          type: string
          format: uuid
      responses:
        '202':
          description: Accepted
      tags:
        - Clusters
  /v1/cluster/:
    delete:
      summary: Delete cluster
      responses:
        '202':
          description: Accepted
      tags:
        - Clusters
  /osd-volumes/versions/:
    get:
      summary: List of versions
      tags:
        - Volumes
      responses:
        '200':
          description: An array of version strings
          schema:
            type: array
            items:
              type: string
  /v1/osd-volumes/:
    get:
      summary: List of Volumes
      description: |
        Returns information on provisioned volumes
      parameters:
        - name: Name
          in: query
          description: User specified volume name
          required: false
          type: string
        - name: Label
          in: query
          description: Comma separated name value pairs
          required: false
          type: string
        - name: ConfigLabel
          in: query
          description: Comma separated name value pairs
          required: false
          type: string
        - name: VolumeID
          in: query
          description: Volume uuid
          required: false
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: An array of Volumes
          schema:
            type: array
            items:
              $ref: '#/definitions/Volume'
          examples:
              application/json: |-
                [
                  {
                    "id": "186672328357254033",
                    "readonly": false,
                    "locator": {
                      "name": "cassandra-vol"
                    },
                    "ctime": "2017-03-31T19:06:58Z",
                    "spec": {
                      "ephemeral": false,
                      "size": "1073741824",
                      "format": "ext4",
                      "block_size": "32768",
                      "ha_level": "1",
                      "cos": "low",
                      "io_profile": "sequential",
                      "dedupe": false,
                      "snapshot_interval": 0,
                      "shared": false,
                      "replica_set": {},
                      "aggregation_level": 1,
                      "encrypted": false,
                      "passphrase": "",
                      "snapshot_schedule": "",
                      "scale": 1,
                      "sticky": false,
                      "max_backups": 0,
                      "backup_schedule": ""
                    },
                    "usage": "33964032",
                    "last_scan": "2017-03-31T19:06:58Z",
                    "format": "ext4",
                    "status": "up",
                    "state": "attached",
                    "attached_on": "e612618a-3c8f-490d-b288-674089de7254",
                    "device_path": "e612618a-3c8f-490d-b288-674089de7254",
                    "replica_sets": [
                      {
                        "nodes": [
                          "e612618a-3c8f-490d-b288-674089de7254"
                        ]
                      }
                    ],
                    "error": "",
                    "runtime_state": [
                      {
                        "runtime_state": {
                          "FullResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "ID": "0",
                          "ReadQuorum": "1",
                          "ReadSet": "[1]",
                          "ReplicaSetCurr": "[1]",
                          "ReplicaSetNext": "[1]",
                          "ResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "RuntimeState": "clean",
                          "TimestampBlocksPerNode": "[0 0 0 0 0]",
                          "TimestampBlocksTotal": "0",
                          "WriteQuorum": "1",
                          "WriteSet": "[1]"
                        }
                      }
                    ],
                    "secure_device_path": "",
                    "background_processing": true
                  },
                  {
                    "id": "371602944628495728",
                    "readonly": false,
                    "locator": {
                      "name": "mysql-vol"
                    },
                    "ctime": "2017-03-31T19:10:55Z",
                    "spec": {
                      "ephemeral": false,
                      "size": "2147483648",
                      "format": "ext4",
                      "block_size": "32768",
                      "ha_level": "1",
                      "cos": "low",
                      "io_profile": "sequential",
                      "dedupe": false,
                      "snapshot_interval": 0,
                      "shared": false,
                      "replica_set": {},
                      "aggregation_level": 1,
                      "encrypted": false,
                      "passphrase": "",
                      "snapshot_schedule": "",
                      "scale": 1,
                      "sticky": false,
                      "max_backups": 0,
                      "backup_schedule": ""
                    },
                    "usage": "67788800",
                    "last_scan": "2017-03-31T19:10:55Z",
                    "format": "ext4",
                    "status": "up",
                    "state": "attached",
                    "attached_on": "e612618a-3c8f-490d-b288-674089de7254",
                    "device_path": "e612618a-3c8f-490d-b288-674089de7254",
                    "replica_sets": [
                      {
                        "nodes": [
                          "e612618a-3c8f-490d-b288-674089de7254"
                        ]
                      }
                    ],
                    "error": "",
                    "runtime_state": [
                      {
                        "runtime_state": {
                          "FullResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "ID": "0",
                          "ReadQuorum": "1",
                          "ReadSet": "[1]",
                          "ReplicaSetCurr": "[1]",
                          "ReplicaSetNext": "[1]",
                          "ResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "RuntimeState": "clean",
                          "TimestampBlocksPerNode": "[0 0 0 0 0]",
                          "TimestampBlocksTotal": "0",
                          "WriteQuorum": "1",
                          "WriteSet": "[1]"
                        }
                      }
                    ],
                    "secure_device_path": "",
                    "background_processing": true
                  },
                  {
                    "id": "556970537543779086",
                    "readonly": false,
                    "locator": {
                      "name": "mysql_volume"
                    },
                    "ctime": "2017-03-30T02:02:35Z",
                    "spec": {
                      "ephemeral": false,
                      "size": "1073741824",
                      "format": "ext4",
                      "block_size": "65536",
                      "ha_level": "1",
                      "cos": "low",
                      "io_profile": "sequential",
                      "dedupe": false,
                      "snapshot_interval": 0,
                      "shared": false,
                      "aggregation_level": 1,
                      "encrypted": false,
                      "passphrase": "",
                      "snapshot_schedule": "",
                      "scale": 0,
                      "sticky": false,
                      "max_backups": 0,
                      "backup_schedule": ""
                    },
                    "usage": "254148608",
                    "last_scan": "2017-03-30T02:02:35Z",
                    "format": "ext4",
                    "status": "up",
                    "state": "attached",
                    "attached_on": "e612618a-3c8f-490d-b288-674089de7254",
                    "device_path": "/dev/pxd/pxd556970537543779086",
                    "attach_path": [
                      "/var/lib/osd/mounts/mysql_volume"
                    ],
                    "replica_sets": [
                      {
                        "nodes": [
                          "e612618a-3c8f-490d-b288-674089de7254"
                        ]
                      }
                    ],
                    "error": "",
                    "runtime_state": [
                      {
                        "runtime_state": {
                          "FullResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "ID": "0",
                          "ReadQuorum": "1",
                          "ReadSet": "[1]",
                          "ReplicaSetCurr": "[1]",
                          "ReplicaSetNext": "[1]",
                          "ResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "RuntimeState": "clean",
                          "TimestampBlocksPerNode": "[0 0 0 0 0]",
                          "TimestampBlocksTotal": "0",
                          "WriteQuorum": "1",
                          "WriteSet": "[1]"
                        }
                      }
                    ],
                    "secure_device_path": "",
                    "background_processing": false
                  }
                ]
    post:
        summary: Create New Volume
        description: Create new volume according to spec
        parameters:
          - name: spec
            in: body
            description: |
             Volume create path example:
             POST /v1/osd-volumes
              Volume spec example:
              ``` json
                  "locator": {
                     "name": "cassandra-vol",
                     "labels":{
                        SLA: "Gold"
                        }
                    }
                  "spec": {
                     "ephemeral": false,
                     "size": "10737418240",
                     "format": "ext4",
                     "block_size": "32768",
                     "ha_level": "1",
                     "cos": "low",
                     "io_profile": "sequential",
                     "dedupe": false,
                     "snapshot_interval": 0,
                     "shared": false,
                     "replica_set": {

                     }
                    }
              ```
            required: true
            schema:
              $ref: '#/definitions/VolumeCreateRequest'
        tags:
          - Volumes
        responses:
          '200':
            description: |
             UUID of newly created volume.
             On failure's, a detailed error message will be available as below
            schema:
              $ref: '#/definitions/VolumeCreateResponse'
            examples:
             application/json: |-
              {
                 "id": "713030761715548077",
                 "volume_response": {}
                }
  /v1/osd-volumes/{uuid}/:
    get:
      summary: Inspect volume
      description: |
        Retrieves volume as specified by UUID
      parameters:
        - name: uuid
          in: path
          description: Volume UUID or Name
          required: true
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: Volume
          schema:
            $ref: '#/definitions/Volume'
          examples:
             application/json: |-
              [{
                    "id": "960911126757490171",
                    "readonly": false,
                    "locator": {
                     "name": "cassandra-vol"
                    },
                    "ctime": "2017-03-31T18:27:23Z",
                    "spec": {
                     "ephemeral": false,
                     "size": "10737418240",
                     "format": "ext4",
                     "block_size": "32768",
                     "ha_level": "1",
                     "cos": "low",
                     "io_profile": "sequential",
                     "dedupe": false,
                     "snapshot_interval": 0,
                     "shared": false,
                     "replica_set": {

                     },
                     "aggregation_level": 1,
                     "encrypted": false,
                     "passphrase": "",
                     "snapshot_schedule": "",
                     "scale": 1,
                     "sticky": false,
                     "max_backups": 0,
                     "backup_schedule": ""
                    },
                    "usage": "138682368",
                    "last_scan": "2017-03-31T18:27:23Z",
                    "format": "ext4",
                    "status": "up",
                    "state": "detached",
                    "attached_on": "",
                    "device_path": "",
                    "replica_sets": [
                     {
                      "nodes": [
                       "456b5368-f8b4-40c7-aa85-ea35e4b515a4"
                      ]
                     }
                    ],
                    "error": "",
                    "runtime_state": [
                     {
                      "runtime_state": {
                       "FullResyncBlocks": "[{0 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                       "ID": "0",
                       "ReadQuorum": "1",
                       "ReadSet": "[0]",
                       "ReplicaSetCurr": "[0]",
                       "ReplicaSetNext": "[0]",
                       "ResyncBlocks": "[{0 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                       "RuntimeState": "clean",
                       "TimestampBlocksPerNode": "[0 0 0 0 0]",
                       "TimestampBlocksTotal": "0",
                       "WriteQuorum": "1",
                       "WriteSet": "[0]"
                      }
                     }
                    ],
                    "secure_device_path": "",
                    "background_processing": true
                    }]
                  }
    put:
        summary: Change volume state
        description: |
          Attach, detach, format, mount and unmount operations
        parameters:
          - name: uuid
            in: path
            description: |
             Volume UUID or name as path parameter example:
             PUT /v1/osd-volumes/cassandra-vol
            required: true
            type: string
            format: uuid
          - name: state
            in: body
            description: |
              Desired Volume State attach example:
               ``` json
                   {
                     "action": {
                        "attach: 2"
                        }
                   }
              ```
              Desired Volume State detach example:
               ``` json
                   {
                     "action": {
                        "attach: 1"
                        }
                   }
              ```
              Desired Volume State mount example:
               ``` json
                   {
                     "action": {
                        "mount: 2",
                        "mount_path:"/tmp""
                        }
                   }
              ```
              Desired Volume State unmount example:
               ``` json
                   {
                     "action": {
                        "mount: 1",
                        "mount_path:"/tmp""
                        }
                   }
              ```
            required: true
            schema:
              $ref: '#/definitions/VolumeStateParams'
        tags:
          - Volumes
        responses:
          '200':
            description: |
             Operation result of Attach/Detach/Mount/Unmount
            schema:
              $ref: '#/definitions/VolumeStateParams'
            examples:
             application/json: |-
                {
                  "volume": {
                    "id": "567662444761523200",
                    "locator": {
                      "name": "cassandra-vol"
                    },
                    "ctime": {
                      "seconds": 1491195375,
                      "nanos": 503891611
                    },
                    "spec": {
                      "size": 1073741824,
                      "format": 2,
                      "block_size": 32768,
                      "ha_level": 1,
                      "cos": 1,
                      "replica_set": {},
                      "aggregation_level": 1,
                      "scale": 1
                    },
                    "usage": 33964032,
                    "last_scan": {
                      "seconds": 1491195375,
                      "nanos": 503891948
                    },
                    "format": 2,
                    "status": 2,
                    "state": 3,
                    "attached_on": "e612618a-3c8f-490d-b288-674089de7254",
                    "device_path": "/dev/pxd/pxd567662444761523200",
                    "attach_path": [
                      "/tmp"
                    ],
                    "replica_sets": [
                      {
                        "nodes": [
                          "e612618a-3c8f-490d-b288-674089de7254"
                        ]
                      }
                    ],
                    "runtime_state": [
                      {
                        "runtime_state": {
                          "FullResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "ID": "0",
                          "ReadQuorum": "1",
                          "ReadSet": "[1]",
                          "ReplicaSetCurr": "[1]",
                          "ReplicaSetNext": "[1]",
                          "ResyncBlocks": "[{1 0} {-1 0} {-1 0} {-1 0} {-1 0}]",
                          "RuntimeState": "clean",
                          "TimestampBlocksPerNode": "[0 0 0 0 0]",
                          "TimestampBlocksTotal": "0",
                          "WriteQuorum": "1",
                          "WriteSet": "[1]"
                        }
                      }
                    ]
                  }
                }
    delete:
        summary: Delete Volume
        description: |
          Delete Volume
        parameters:
          - name: uuid
            in: path
            description: |
             Volume UUID as path parameter example:
             DELETE /v1/osd-volumes/myvolume
            required: true
            type: string
            format: uuid
        tags:
          - Volumes
        responses:
          '200':
            description: Volume Deleted
            schema:
              $ref: '#/definitions/UUID'
  /v1/osd-volumes/stats/:
    get:
      summary: Retrieve Volume Stats
      description: |
        Retrieve Volume Stats
      tags:
        - Volumes
      responses:
        '200':
          description: Volume Stats
          schema:
            $ref: '#/definitions/VolumeStats'
  /v1/osd-volumes/stats/{uuid}/:
    get:
      summary: Retrieve Volume Stats
      description: |
        Retrieve Volume Stats for specified UUID
      parameters:
        - name: uuid
          in: path
          description: Volume UUID
          required: true
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: Volume stats
          schema:
            $ref: '#/definitions/VolumeStats'
  /v1/osd-volumes/usedsize/:
    get:
      summary: Retrieves volumes used space size
      description: |
        Retrieve Volume Stats
      tags:
        - Volumes
      responses:
        '200':
          description: Volumes used space sizes
          schema:
            type: array
            items:
              type: number
  /v1/osd-volumes/usedsize/{uuid}/:
    get:
      summary: Retrieve volume used disk size
      description: |
        Retrieve volume used space size for specified UUID
      parameters:
        - name: uuid
          in: path
          description: Volume UUID
          required: true
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: Volume used space
          schema:
            type: number
  /v1/osd-volumes/alerts/:
    get:
      summary: Retrieve Volume Alerts
      description: |
        Retrieve Volume Alerts
      tags:
        - Volumes
      responses:
        '200':
          description: Volume Alerts
          schema:
            $ref: '#/definitions/VolumeAlerts'
          examples:
             application/json: |-
                [{
                   "id": "10",
                   "severity": "SEVERITY_TYPE_NOTIFY",
                   "alert_type": "4",
                   "message": "Volume (Name: h, Id: 186672328357254033) created successfully.",
                   "timestamp": "2017-03-31T19:06:59Z",
                   "resource_id": "186672328357254033",
                   "resource": "RESOURCE_TYPE_VOLUME",
                   "cleared": false,
                   "ttl": "43200"
                  },{
                   "id": "11",
                   "severity": "SEVERITY_TYPE_NOTIFY",
                   "alert_type": "4",
                   "message": "Volume (Name: sample, Id: 371602944628495728) created successfully.",
                   "timestamp": "2017-03-31T19:10:56Z",
                   "resource_id": "371602944628495728",
                   "resource": "RESOURCE_TYPE_VOLUME",
                   "cleared": false,
                   "ttl": "43200"
                  },{
                   "id": "12",
                   "severity": "SEVERITY_TYPE_NOTIFY",
                   "alert_type": "4",
                   "message": "Volume (Id: 6160761704448908 Name: 556970537543779086.snap2017-03-31T23:30:45.368202632Z) snapshot created with source volume: 556970537543779086",
                   "timestamp": "2017-03-31T23:30:45Z",
                   "resource_id": "6160761704448908",
                   "resource": "RESOURCE_TYPE_VOLUME",
                   "cleared": false,
                   "ttl": "43200"
                  }]
  /v1/osd-volumes/alerts/{uuid}/:
    get:
      summary: Retrieve Volume Alerts
      description: |
        Retrieve Volume Alerts for specified UUID
      parameters:
        - name: uuid
          in: path
          description: Volume UUID
          required: true
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: Volume Alerts
          schema:
            $ref: '#/definitions/VolumeAlerts'
  /v1/osd-volumes/requests/:
    get:
      summary: Retrieve Volume Requests
      description: |
        Retrieve Volume Requests
      tags:
        - Volumes
      responses:
        '200':
          description: Volume Requests
          schema:
            $ref: '#/definitions/VolumeActiveRequests'
  /v1/osd-volumes/requests/{uuid}/:
    get:
      summary: Retrieve Volume Requests
      description: |
        Retrieve Volume Requests for specified UUID
      parameters:
        - name: uuid
          in: path
          description: Volume UUID
          required: true
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: Volume Requests
          schema:
            $ref: '#/definitions/VolumeActiveRequests'
  /v1/osd-snapshots/:
    get:
      summary: List of snapshots
      description: |
        Returns information on snapshots
      parameters:
        - name: name
          in: query
          description: Volume name that maps to this snap
          required: false
          type: string
        - name: VolumeLabels
          in: query
          description: Comma separated volume labels
          required: false
          type: string
        - name: SnapLabels
          in: query
          description: Comma separated snap labels
          required: false
          type: string
        - name: uuid
          in: query
          description: Snap UUID
          required: false
          type: string
          format: uuid
      tags:
        - Volumes
      responses:
        '200':
          description: An array of VolumeSnaps
          schema:
            type: array
            items:
              $ref: '#/definitions/VolumeSnap'
          examples:
             application/json: |-
                [
                  {
                    "id": "6160761704448908",
                    "source": {
                      "parent": "556970537543779086",
                      "seed": ""
                    },
                    "readonly": false,
                    "locator": {
                      "name": "556970537543779086.snap2017-03-31T23:30:45.368202632Z"
                    },
                    "ctime": "2017-03-31T23:30:45Z",
                    "spec": {
                      "ephemeral": false,
                      "size": "1073741824",
                      "format": "ext4",
                      "block_size": "65536",
                      "ha_level": "1",
                      "cos": "low",
                      "io_profile": "sequential",
                      "dedupe": false,
                      "snapshot_interval": 0,
                      "shared": false,
                      "aggregation_level": 1,
                      "encrypted": false,
                      "passphrase": "",
                      "snapshot_schedule": "",
                      "scale": 0,
                      "sticky": false,
                      "max_backups": 0,
                      "backup_schedule": ""
                    },
                    "usage": "254148608",
                    "last_scan": "2017-03-31T23:30:45Z",
                    "format": "ext4",
                    "status": "up",
                    "state": "detached",
                    "attached_on": "",
                    "device_path": "",
                    "replica_sets": [
                      {
                        "nodes": [
                          "e612618a-3c8f-490d-b288-674089de7254"
                        ]
                      }
                    ],
                    "error": "",
                    "secure_device_path": "",
                    "background_processing": false
                  }
                ]
    post:
        summary: Create New Snapshot
        description: Create new volume according to spec
        parameters:
          - name: snapParams
            in: body
            description: |
              Snapshot Params example:
               ``` json
                   {
                     "id":"cassandra-vol",
                     "locator":
                              {"name":"dbsnap"},
                      "readonly":true
                   }
              ```
            required: true
            schema:
              $ref: '#/definitions/SnapCreateParams'
        tags:
          - Volumes
        responses:
          '200':
            description: UUID of newly created snapshot
            schema:
              $ref: '#/definitions/UUID'
            examples:
             application/json: |-
                {
                  "volume_create_response": {
                    "id": "376740775858546908",
                    "volume_response": {}
                  }
                }
definitions:
  VolumeResponse:
    properties:
      Error:
        type: string
        description: Error text
  VolumeCreateRequest:
    properties:
      locator:
        $ref: '#/definitions/Locator'
      spec:
        $ref: '#/definitions/VolumeSpec'
      options:
        $ref: '#/definitions/CreateOptions'
  VolumeCreateResponse:
    properties:
      Id:
        type: string
        format: uuuid
      VolumeResponse:
        $ref: '#/definitions/VolumeResponse'
  Volume:
    properties:
      uuid:
        type: string
        format: uuid
        description: unique volume UUID
      locator:
        $ref: '#/definitions/Locator'
      ctime:
        type: string
        description: Creation time
      spec:
        $ref: '#/definitions/VolumeSpec'
      status:
        type: string
        description: Volume op status
        enum:
          - NotPresent
          - Up
          - Down
          - Degraded
      state:
        type: number
        description: >-
          Volume state. 1 -> CreatePending, 2->Available, 4->Attached,
          8->Detached, 16->ErrorState, 32->Deleted
      format:
        type: string
        description: Filesystem for this volume
        enum:
          - xfs
          - ext4
          - zfs
          - none
      usage:
        type: number
        format: int64
        description: Physical blocks used on this volume
      scan_time:
        type: string
        description: Last time this volume was scanned for data integrity
      attached_on:
        type: string
        description: Node on which volume is attached
      replica_set:
        type: array
        items:
          type: string
        description: List of nodes where data is erasure coded
      device_path:
        type: string
        description: Attach path for block devices
      mount_path:
        type: array
        items:
          type: string
        description: Paths at which the volumes is mounted
      error:
        type: string
        description: Last error on this volume
  VolumeSpec:
    properties:
      ephemeral:
        type: boolean
        description: True for ephemeral disks
      size:
        type: number
        format: int64
        description: Maximum size
      blocksize:
        type: number
        format: int32
        description: Desired fs block size
      halevel:
        type: number
        description: >-
          A number specifying the number of nodes that are allowed to fail and
          data be still available
      cos:
        type: number
        minimum: 1
        maximum: 10
        description: A number between 1 and 10 that specified a class of service
      dedupe:
        type: boolean
        description: Enable or disable deduplication
      snapshot_interval:
        type: number
        description: >-
          A number in minutes specifying how oftene snapshots should be taken. 0
          disables snapshots
      snapshot_depth:
        type: number
        description: Number of snapshots to keep
      config_labels:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
        description: Arbitrary name value configuration pairs
  CreateOptions:
    properties:
      fail_if_exists:
        type: boolean
        description: Fail if volume with matching locator exists
      create_from_snap:
        type: string
        format: uuid
        description: create volume from specified snapshot
  Locator:
    properties:
      name:
        type: string
        description: user assigned name
      labels:
        type: string
        description: comma seperated name value pairs
  VolumeStateParams:
    properties:
      mount:
        type: integer
        format: int32
        description: '1 to mount, 2 to unmount'
      format:
        type: integer
        format: int32
        description: 1 to format
      attach:
        type: integer
        format: int32
        description: '1 to attach, 2 to detach'
      mountpath:
        type: string
        description: Path to mount the device
  UUID:
    properties:
      name:
        type: string
        description: Volume UUID
        format: uuid
  NameValuePair:
    properties:
      name:
        type: string
        description: Name
      value:
        type: string
        description: Value
  VolumeStats:
    properties:
      stats:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
        description: Stats name and value array
  VolumeAlerts:
    properties:
      stats:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
        description: Alerts name and description array
  VolumeSnap:
    properties:
      uuid:
        type: string
        format: uuid
        description: Unique snap UUID
      volume_uuid:
        type: string
        format: uuid
        description: Volume UUID that maps to this snapshot
      ctime:
        type: string
        description: Creation time
      usage:
        type: number
        format: int64
        description: Physical blocks used for this snap
      snap_labels:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
        description: Arbitrary name value pairs
  SnapCreateParams:
    properties:
      uuid:
        type: string
        format: uuid
        description: UUID of volume to snap
      labels:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
        description: Arbitrary name value pairs
  ActiveRequest:
    properties:
      requestKV:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
  VolumeActiveRequests:
    properties:
      RequestCount:
        type: number
        format: int64
        description: Number of active requests
      ActiveRequest:
        type: array
        items:
          $ref: '#/definitions/ActiveRequest'
  StoragePool:
    properties:
      ID:
        type: string
        format: uuid
      Cos:
        type: number
        format: int
      Medium:
        type: number
        format: int
      RaidLevel:
        type: string
      TotalSize:
        type: number
        format: uint64
      Used:
        type: number
        format: uint64
  Node:
    properties:
      Id:
        type: string
        format: uuid
      Cpu:
        type: number
        format: float64
      MemTotal:
        type: number
        format: uint64
      MemUsed:
        type: number
        format: uint64
      MemFree:
        type: number
        format: uint64
      AvgLoad:
        type: number
        format: int
      GenNumber:
        type: number
        format: uint64
      Status:
        type: string
        enum:
          - STATUS_NONE
          - STATUS_INIT
          - STATUS_OK
          - STATUS_OFFLINE
          - STATUS_ERROR
          - STATUS_NOT_IN_QUORUM
          - STATUS_DECOMMISSION
          - STATUS_MAINTENANCE
          - STATUS_STORAGE_DOWN
          - STATUS_STORAGE_DEGRADED
          - STATUS_NEEDS_REBOOT
          - STATUS_STORAGE_REBALANCE
          - STATUS_STORAGE_DRIVE_REPLACE
          - STATUS_MAX
      Disks:
        type: array
        items:
          type: string
      Pools:
        type: array
        items:
          $ref: '#/definitions/StoragePool'
      MgmtIp:
        type: string
        format: uuid
      DataIp:
        type: string
        format: uuid
      Timestamp:
        type: string
      StartTime:
        type: string
      Hostname:
        type: string
      NodeData:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
      NodeLabels:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
  Cluster:
    properties:
      Id:
        type: string
        format: uuid
      Status:
        type: string
        enum:
          - STATUS_NONE
          - STATUS_INIT
          - STATUS_OK
          - STATUS_OFFLINE
          - STATUS_ERROR
          - STATUS_NOT_IN_QUORUM
          - STATUS_DECOMMISSION
          - STATUS_MAINTENANCE
          - STATUS_STORAGE_DOWN
          - STATUS_STORAGE_DEGRADED
          - STATUS_NEEDS_REBOOT
          - STATUS_STORAGE_REBALANCE
          - STATUS_STORAGE_DRIVE_REPLACE
          - STATUS_MAX
      NodeId:
        type: string
        format: uuid
      Nodes:
        type: array
        items:
          $ref: '#/definitions/Node'
  NodeValue:
    properties:
      Id:
        type: string
        format: uuid
      GenNumber:
        type: number
        format: uint64
      LastUpdateTs:
        type: string
      Status:
        type: string
      Value:
        type: string
  GossipSessionInfo:
    properties:
      Node:
        type: string
      Ts:
        type: string
      Dir:
        type: number
        format: uint8
      Err:
        type: string
      Op:
        type: string
  ClusterState:
    properties:
      History:
        type: array
        items:
          $ref: '#/definitions/GossipSessionInfo'
      NodeStatus:
        type: array
        items:
          $ref: '#/definitions/NodeValue'
  StatPoint:
    properties:
      Name:
        type: string
      Tags:
        type: array
        items:
          $ref: '#/definitions/NameValuePair'
      Fields:
        type: array
        items:
          type: string
      Timestamp:
        type: number
        format: int64
